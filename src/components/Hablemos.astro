<!-- Sección de Hablemos -->
<section
  id="contenido7"
  class="w-full md:px-16 px-5 py-8 min-h-screen flex flex-col items-center justify-center bg-[#1a1a1a] g-hero-pattern bg-repeat w-full min-h-screen bg-[url(/img/fondo.png)] bg-no-repeat bg-cover bg-center"
>
  <div
    class="flex flex-col items-center px-5 py-2 h-full text-center max-w-7xl w-full "
  >
    <!-- Título rediseñado con estilo del sitio -->
    <div class="sticky-title w-full mb-12">
      <h1 class="text-2xl sm:text-3xxl md:text-4xl lg:text-5xl font-black mb-6 leading-tight">
        <span class="text-white">Como creamos </span>
        <span class="text-transparent bg-clip-text bg-gradient-to-r from-red-500 via-pink-500 to-red-600">juntos estos productos</span>
      </h1>

      <p class="text-lg md:text-xl lg:text-2xl text-gray-300 font-light max-w-3xl mx-auto leading-relaxed">
        Descubre nuestros proyectos, tutoriales y consejos sobre desarrollo de software e inteligencia artificial
      </p>

      <!-- Línea decorativa -->
      <div class="mt-8 flex items-center justify-center gap-2">
        <div class="h-px w-16 md:w-24 bg-gradient-to-r from-transparent to-red-500"></div>
        <div class="w-2 h-2 rounded-full bg-red-500"></div>
        <div class="h-px w-16 md:w-24 bg-gradient-to-l from-transparent to-red-500"></div>
      </div>
    </div>

    <!-- Layout responsive de videos -->
    <div class="flex flex-col lg:flex-row gap-6 w-full max-w-7xl" id="video-section">
      <!-- Video principal con controles -->
      <div class="w-full lg:w-[75%] flex flex-col gap-4">
        <div class="aspect-video bg-black rounded-xl overflow-hidden shadow-2xl border-2 border-gray-700">
          <div id="main-player"></div>
        </div>

        <!-- Controles de navegación -->
        <div class="flex items-center justify-between gap-4 px-2">
          <button
            id="prev-btn"
            class="flex items-center gap-2 px-5 py-3 bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-700 hover:to-pink-700 text-white rounded-lg transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl hover:scale-105"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
            <span class="hidden sm:inline font-semibold">Anterior</span>
          </button>

          <div class="flex items-center gap-3 bg-gray-800/50 px-4 py-2 rounded-lg">
            <span id="current-video-number" class="text-red-500 font-bold text-lg">1</span>
            <span class="text-gray-400">/</span>
            <span id="total-videos" class="text-gray-300 font-semibold">10</span>
          </div>

          <button
            id="next-btn"
            class="flex items-center gap-2 px-5 py-3 bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-700 hover:to-pink-700 text-white rounded-lg transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl hover:scale-105"
          >
            <span class="hidden sm:inline font-semibold">Siguiente</span>
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </button>
        </div>
      </div>

      <!-- Carousel vertical de videos -->
      <div class="w-full lg:w-[25%] flex flex-col gap-3">
        <!-- Header del carousel -->
        <div class="flex items-center justify-between px-3 py-2.5 bg-gradient-to-r from-gray-800/40 to-gray-800/30 rounded-lg border border-gray-700/80 shadow-lg">
          <h3 class="text-white font-bold text-sm flex items-center gap-2">
            <svg class="w-4 h-4 text-red-500" fill="currentColor" viewBox="0 0 24 24">
              <path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z"></path>
            </svg>
            Lista de Videos
          </h3>
          <button
            id="scroll-up"
            class="p-1.5 text-red-500 hover:bg-red-500/20 rounded-md transition-all hover:scale-110"
          >
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"></path>
            </svg>
          </button>
        </div>

        <!-- Container de videos scrollable -->
        <div
          id="carousel-container"
          class="flex flex-col gap-2.5 overflow-y-auto max-h-[500px] pr-2 custom-scrollbar scroll-smooth"
        >
          <!-- Los videos se generarán dinámicamente -->
        </div>

        <!-- Botón scroll down -->
        <div class="flex justify-center">
          <button
            id="scroll-down"
            class="p-1.5 text-red-500 hover:bg-red-500/20 rounded-md transition-all hover:scale-110"
          >
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  // Lista de videos de YouTube (Reemplaza estos IDs con tus videos reales)
  const videos = [
    {
      id: "dQw4w9WgXcQ", // Video 1
      title: "Desarrollo con IA y Machine Learning",
      thumbnail: "https://img.youtube.com/vi/dQw4w9WgXcQ/maxresdefault.jpg",
    },
    {
      id: "M7lc1UVf-VE", // Video 2
      title: "Arquitectura de Software Moderna",
      thumbnail: "https://img.youtube.com/vi/M7lc1UVf-VE/maxresdefault.jpg",
    },
    {
      id: "jNQXAC9IVRw", // Video 3
      title: "React & TypeScript Tutorial",
      thumbnail: "https://img.youtube.com/vi/jNQXAC9IVRw/maxresdefault.jpg",
    },
    {
      id: "9bZkp7q19f0", // Video 4
      title: "Python & Deep Learning",
      thumbnail: "https://img.youtube.com/vi/9bZkp7q19f0/maxresdefault.jpg",
    },
    {
      id: "kJQP7kiw5Fk", // Video 5
      title: "DevOps & Cloud Computing",
      thumbnail: "https://img.youtube.com/vi/kJQP7kiw5Fk/maxresdefault.jpg",
    },
    {
      id: "JU6sl_yyZqs", // Video 6
      title: "Microservicios con Node.js",
      thumbnail: "https://img.youtube.com/vi/JU6sl_yyZqs/maxresdefault.jpg",
    },
    {
      id: "Mus_vwhTCq0", // Video 7
      title: "Docker y Kubernetes",
      thumbnail: "https://img.youtube.com/vi/Mus_vwhTCq0/maxresdefault.jpg",
    },
    {
      id: "gB6WLkSrtJk", // Video 8
      title: "Next.js Full Course",
      thumbnail: "https://img.youtube.com/vi/gB6WLkSrtJk/maxresdefault.jpg",
    },
    {
      id: "RGOj5yH7evk", // Video 9
      title: "GraphQL & Apollo",
      thumbnail: "https://img.youtube.com/vi/RGOj5yH7evk/maxresdefault.jpg",
    },
    {
      id: "tN6oJu2DqCM", // Video 10
      title: "Testing y TDD con Jest",
      thumbnail: "https://img.youtube.com/vi/tN6oJu2DqCM/maxresdefault.jpg",
    },
  ];

  let player: any;
  let currentVideoIndex = 0;
  let isPlayerReady = false;

  // Cargar API de YouTube
  const tag = document.createElement("script");
  tag.src = "https://www.youtube.com/iframe_api";
  const firstScriptTag = document.getElementsByTagName("script")[0];
  firstScriptTag.parentNode?.insertBefore(tag, firstScriptTag);

  // Callback cuando la API está lista
  (window as any).onYouTubeIframeAPIReady = function () {
    player = new (window as any).YT.Player("main-player", {
      height: "100%",
      width: "100%",
      videoId: videos[0].id,
      playerVars: {
        autoplay: 0,
        modestbranding: 1,
        rel: 0,
      },
      events: {
        onReady: onPlayerReady,
        onStateChange: onPlayerStateChange,
      },
    });
  };

  function onPlayerReady() {
    isPlayerReady = true;
    renderCarousel();
    setupControls();
    updateNavigationButtons();
  }

  function onPlayerStateChange(event: any) {
    // Cuando el video termina (estado 0)
    if (event.data === (window as any).YT.PlayerState.ENDED) {
      // Avanzar al siguiente video si no es el último
      if (currentVideoIndex < videos.length - 1) {
        goToNext();
      }
    }
  }

  function loadVideo(index: number) {
    if (isPlayerReady && player && player.loadVideoById) {
      currentVideoIndex = index;
      player.loadVideoById(videos[index].id);
      updateCarouselUI();
      updateNavigationButtons();
      updateVideoCounter();
      scrollToActiveVideo();
    }
  }

  function goToPrev() {
    if (currentVideoIndex > 0) {
      loadVideo(currentVideoIndex - 1);
    }
  }

  function goToNext() {
    if (currentVideoIndex < videos.length - 1) {
      loadVideo(currentVideoIndex + 1);
    }
  }

  function updateNavigationButtons() {
    const prevBtn = document.getElementById("prev-btn");
    const nextBtn = document.getElementById("next-btn");

    if (prevBtn) {
      prevBtn.disabled = currentVideoIndex === 0;
    }

    if (nextBtn) {
      nextBtn.disabled = currentVideoIndex === videos.length - 1;
    }
  }

  function updateVideoCounter() {
    const counter = document.getElementById("current-video-number");
    if (counter) {
      counter.textContent = (currentVideoIndex + 1).toString();
    }
  }

  function scrollToActiveVideo() {
    const activeItem = document.querySelector(".carousel-item.ring-4");
    if (activeItem) {
      activeItem.scrollIntoView({ behavior: "smooth", block: "nearest" });
    }
  }

  function setupControls() {
    // Botones de navegación principal
    const prevBtn = document.getElementById("prev-btn");
    const nextBtn = document.getElementById("next-btn");

    prevBtn?.addEventListener("click", goToPrev);
    nextBtn?.addEventListener("click", goToNext);

    // Botones de scroll del carousel
    const scrollUpBtn = document.getElementById("scroll-up");
    const scrollDownBtn = document.getElementById("scroll-down");
    const carouselContainer = document.getElementById("carousel-container");

    scrollUpBtn?.addEventListener("click", () => {
      if (carouselContainer) {
        carouselContainer.scrollBy({ top: -150, behavior: "smooth" });
      }
    });

    scrollDownBtn?.addEventListener("click", () => {
      if (carouselContainer) {
        carouselContainer.scrollBy({ top: 150, behavior: "smooth" });
      }
    });

    // Total de videos
    const totalVideosEl = document.getElementById("total-videos");
    if (totalVideosEl) {
      totalVideosEl.textContent = videos.length.toString();
    }
  }

  function renderCarousel() {
    const carousel = document.getElementById("carousel-container");
    if (!carousel) return;

    carousel.innerHTML = videos
      .map(
        (video, index) => `
      <div
        class="carousel-item w-full relative cursor-pointer rounded-lg overflow-hidden transition-all duration-300 hover:scale-[1.02] bg-black ${index === currentVideoIndex ? "ring-3 ring-red-500 shadow-lg shadow-red-500/50" : "ring-1 ring-gray-700"}"
        data-index="${index}"
        style="position: relative; width: 100%; padding-bottom: 56.25%;"
      >
        <img
          src="${video.thumbnail}"
          alt="${video.title}"
          class="absolute inset-0 w-full h-full object-cover"
          loading="lazy"
        />
        <div class="absolute inset-0 bg-black/40 flex items-center justify-center hover:bg-black/20 transition-all">
          <div class="w-10 h-10 bg-red-600 rounded-full flex items-center justify-center shadow-lg hover:scale-110 transition-transform">
            <svg class="w-5 h-5 text-white ml-0.5" fill="currentColor" viewBox="0 0 24 24">
              <path d="M8 5v14l11-7z"></path>
            </svg>
          </div>
        </div>
        <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/95 via-black/70 to-transparent p-2">
          <p class="text-white text-xs font-semibold line-clamp-2 leading-tight">${video.title}</p>
        </div>
        ${index === currentVideoIndex ? '<div class="absolute top-2 right-2 w-2.5 h-2.5 bg-red-500 rounded-full animate-pulse shadow-lg shadow-red-500/50"></div>' : ""}
        <div class="absolute top-2 left-2 bg-black/90 px-2 py-0.5 rounded text-white text-xs font-bold">
          ${index + 1}
        </div>
      </div>
    `,
      )
      .join("");

    // Agregar event listeners
    document.querySelectorAll(".carousel-item").forEach((item) => {
      item.addEventListener("click", function () {
        const index = parseInt(this.getAttribute("data-index") || "0");
        loadVideo(index);
      });
    });

    updateVideoCounter();
  }

  function updateCarouselUI() {
    document.querySelectorAll(".carousel-item").forEach((item, index) => {
      if (index === currentVideoIndex) {
        item.classList.add("ring-3", "ring-red-500", "shadow-lg", "shadow-red-500/50");
        item.classList.remove("ring-1", "ring-gray-700");

        // Agregar indicador si no existe
        if (!item.querySelector(".absolute.top-2.right-2")) {
          const indicator = document.createElement("div");
          indicator.className =
            "absolute top-2 right-2 w-2.5 h-2.5 bg-red-500 rounded-full animate-pulse shadow-lg shadow-red-500/50";
          item.appendChild(indicator);
        }
      } else {
        item.classList.remove("ring-3", "ring-red-500", "shadow-lg", "shadow-red-500/50");
        item.classList.add("ring-1", "ring-gray-700");

        // Remover indicador de reproducción
        const indicator = item.querySelector(".absolute.top-2.right-2");
        if (indicator) indicator.remove();
      }
    });
  }
</script>

<style>
  .custom-scrollbar::-webkit-scrollbar {
    width: 6px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 3px;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    background: #ef4444;
    border-radius: 3px;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: #dc2626;
  }

  #main-player {
    width: 100%;
    height: 100%;
  }
</style>